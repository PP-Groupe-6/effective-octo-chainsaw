language: go

dist: xenial

go:
- 1.16

before_install:
  - ./travis/before_install.bash

os:
  - linux

env:
  global:
    - GO111MODULE=off
    - PGX_PRIXBANQUE_DATABASE=postgres://postgres:@127.0.0.1/PrixBanqueDev
    - DEV_PRIXBANQUE_DATABASE_CONNSTRING="postgres://dev:dev@127.0.0.1:5432/PrixBanqueDev"
  matrix:
    - PGVERSION=13 PRIXBANQUE_DEV_CONNSTRING="host=127.0.0.1 port=5432 user=dev password=dev database=PrixbanqueDev"

addons:
  sonarcloud:
    organization: "pp-groupe-6"
    token: ${SONAR_TOKEN}
    
before_script:
  - ./travis/before_script.bash

script:
  - go test -v ./account_microservice
  - go test -v ./transaction_microservice
  - sonar-scanner
